{{define "title"}}Dashboard | Task Manager{{end}}

{{define "content"}}
      <h1 class="text-2xl font-bold mb-6 text-gray-700">Hi, John! ðŸ‘‹</h1>

      <!-- Stats Cards -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-gradient-to-br from-indigo-500 to-purple-500 text-white rounded-2xl p-6 shadow-md">
          <h3 class="text-sm opacity-80 mb-1">Completed</h3>
          <p class="text-4xl font-semibold">{{.Completed}}</p>
        </div>
        <div class="bg-gradient-to-br from-yellow-400 to-orange-500 text-white rounded-2xl p-6 shadow-md">
          <h3 class="text-sm opacity-80 mb-1">In Progress</h3>
          <p class="text-4xl font-semibold">{{.InProgress}}</p>
        </div>
        <div class="bg-white rounded-2xl p-6 shadow-md border border-gray-100">
          <h3 class="text-sm text-gray-500 mb-1">Total Tasks</h3>
          <p class="text-4xl font-semibold text-indigo-600">{{.TotalTasks}}</p>
        </div>
        <div class="bg-white rounded-2xl p-6 shadow-md border border-gray-100">
          <h3 class="text-sm text-gray-500 mb-1">Team Members</h3>
          <p class="text-4xl font-semibold text-gray-700">{{.TotalUsers}}</p>
        </div>
      </div>

      <!-- Recent Tasks & Calendar -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Recent Tasks -->
        <div class="bg-white p-6 rounded-2xl shadow-md">
          <h2 class="text-lg font-semibold mb-4 text-gray-700">Recent Tasks</h2>
          <div class="space-y-4">
            {{range .Tasks}}
            <div class="p-4 rounded-xl border border-gray-100 hover:shadow transition">
              <div class="flex justify-between items-center mb-2">
                <h3 class="font-semibold text-gray-800">{{.Title}}</h3>
                <span class="text-xs px-3 py-1 rounded-full
                  {{if eq .Status "done"}}bg-green-100 text-green-600
                  {{else if eq .Status "inprogress"}}bg-yellow-100 text-yellow-600
                  {{else}}bg-gray-100 text-gray-600{{end}}">
                  {{.Status}}
                </span>
              </div>
              <p class="text-sm text-gray-500">{{.Description}}</p>
              <div class="mt-3 flex justify-between text-xs text-gray-400">
                <span>By: {{.Creator.Name}}</span>
                <span>To: {{.AssignedUser.Name}}</span>
              </div>
            </div>
            {{else}}
            <p class="text-gray-500 text-sm">Tidak ada task.</p>
            {{end}}
          </div>
        </div>

        <!-- Calendar -->
        <div class="bg-white p-6 rounded-2xl shadow-md">
          <h2 class="text-lg font-semibold mb-4 text-gray-700">Calendar</h2>
            <!-- Calendar -->
            <div x-data="calendar()" class="p-4 border border-gray-200 rounded-xl text-center select-none mb-6">
              <div class="flex justify-between items-center mb-3">
                <h3 class="font-semibold text-gray-700" x-text="monthNames[month] + ' ' + year"></h3>
                <div class="space-x-2">
                  <button 
                    @click="prevMonth" 
                    class="rounded-full bg-gray-100 hover:bg-indigo-100 text-gray-600 hover:text-indigo-600 transition">
                    <i class="fas fa-arrow-left px-2"></i>
                  </button>
                  <button 
                    @click="nextMonth" 
                    class="rounded-full bg-gray-100 hover:bg-indigo-100 text-gray-600 hover:text-indigo-600 transition">
                    <i class="fas fa-arrow-right px-2"></i>
                  </button>
                </div>
              </div>

            <div class="grid grid-cols-7 gap-1 text-xs font-semibold text-gray-500 mb-1">
              <template x-for="d in dayNames" :key="d">
                <div x-text="d"></div>
              </template>
            </div>
            <div class="grid grid-cols-7 gap-1 text-sm">
              <template x-for="blank in blanks" :key="'b'+blank">
                <div></div>
              </template>
              <template x-for="day in daysInMonth" :key="day">
                <div
                  class="p-2 rounded-full hover:bg-indigo-200 cursor-pointer"
                  :class="{'bg-indigo-500 text-white font-semibold': day === date && month === currentMonth && year === currentYear}"
                  x-text="day"
                ></div>
              </template>
            </div>
          </div>

          <!-- Real-time Clock -->
          <div x-data="clock()" class="text-center mt-4">
            <p class="text-sm text-indigo-500" x-text="timeString"></p>
          </div>
        </div>

      </div>

  <!-- Calendar Script -->
  <script>
    function calendar() {
      const today = new Date();
      return {
        currentMonth: today.getMonth(),
        currentYear: today.getFullYear(),
        month: today.getMonth(),
        year: today.getFullYear(),
        date: today.getDate(),
        dayNames: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
        monthNames: [
          'January', 'February', 'March', 'April', 'May', 'June',
          'July', 'August', 'September', 'October', 'November', 'December'
        ],
        get daysInMonth() { return new Date(this.year, this.month + 1, 0).getDate(); },
        get blanks() { return new Date(this.year, this.month, 1).getDay(); },
        nextMonth() { if (this.month === 11) { this.month = 0; this.year++; } else { this.month++; } },
        prevMonth() { if (this.month === 0) { this.month = 11; this.year--; } else { this.month--; } }
      }
    }

    function clock() {
      return {
        timeString: '',
        init() {
          this.updateTime();
          setInterval(() => this.updateTime(), 1000);
        },
        updateTime() {
          const now = new Date();
          const options = { weekday: 'long' };
          const day = now.toLocaleDateString('en-US', options);
          const time = now.toLocaleTimeString('en-US', { hour12: false });
          this.timeString = `Today is ${day}, ${time}`;
        }
      }
    }
  </script>
{{end}}
